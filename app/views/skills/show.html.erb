<div class="container">
  <div class="row">
    <div class="col-xs-12 col-sm-6 col-sm-offset-3">
      <div class="text-center">
        <h1><%= @skill.title %></h1>
        <h3><%= @skill.city %></h3>
        <p><%= @skill.description %></p>
        <p><%= @skill.price %> € per day</p>
        <% @skill.reviews.each do |review| %>
          <p><%= review.title %></p>
          <p><%= review.description %></p>
        <% end %>
        <% image_url = @skill.photo.present? ? cl_image_path(@skill.photo, height: 200, width: 200, crop: :thumb) : asset_url('youpi-default.jpg') %>


          <%= image_tag image_url, class: 'image-size'%>
      </div>
      <div class="avatar-skillshow-pic">
        <%= link_to user_path(@skill.user) do %>
        <% avatar_url = @skill.user.facebook_picture_url || @skill.user.photo || "http://placehold.it/30x30"%>
        <%= image_tag avatar_url, class: 'avatar-xl'%>
        <% end %>
      </div>
      <% if @skill.user == current_user %>
        <p class="text-center"><%= link_to 'Edit skill' , edit_skill_path(@skill), class: "btn btn-primary" %></p>
      <% elsif current_user!= nil %>

      <div class="container-formulaire">
        `<div class="pricing-bar">
          <div class="price">
            Pricing: <%= @skill.price %>€/day
          </div>
        </div>
        <div class="formulaire">
          <%= simple_form_for [@skill, @booking] do |f| %>
            <%= f.error_notification %>

            <%= f.input :start_date, id: "start_date" %>
            <%= f.input :end_date, id: "end_date" %>
            <%= f.hidden_field :status, value: "pending" %>
            <%= f.submit 'Book it!', class: "btn btn-primary" %>
          <% end %>
        </div>
          <div class="final-price">
              Final Price: <span id="final-pricing"></span>
          </div>

      </div>


        <div class="text-center">
        <p><%= link_to "Back to list of skills", skills_path(@skill), class: "btn btn-info back-button" %></p>
        </div>
      <% end %>
    </div>
  </div>
</div>
<% content_for(:after_js) do %>
  <script type="text/javascript">
    $('#booking_start_date').datepicker({
    });
    $('#booking_end_date').datepicker({
    });
  </script>
  <script>
    $('#booking_start_date', '#booking_end_date').change(function(e){
    var start = $('#booking_start_date').val();
    var end = $('#booking_end_date').val();
    var startDate = new Date(start);
    var endDate = new Date(end);
    var diffDays = parseInt((endDate - startDate) / (1000 * 60 * 60 * 24));
    var finalPrice = diffDays*<%= @skill.price %>;
    $('#final-pricing').html(finalPrice);
  });
  </script>
<% end %>


